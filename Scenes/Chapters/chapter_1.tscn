[gd_scene load_steps=32 format=3 uid="uid://cb5xtdcmais5e"]

[ext_resource type="PackedScene" uid="uid://cnlhyf2lsapee" path="res://Assets/Player/player.tscn" id="1_ghnbm"]
[ext_resource type="Script" uid="uid://dova88ckm60fj" path="res://Scripts/Camera/CameraHandler.cs" id="2_r3dki"]
[ext_resource type="PackedScene" uid="uid://dcji7fr6l835u" path="res://Assets/SpaceStation/player_room/player_room.tscn" id="3_dupto"]
[ext_resource type="PackedScene" uid="uid://dwayucwjjh32f" path="res://Assets/SpaceStation/Prefabs/Garage_Ship.tscn" id="4_2ya38"]
[ext_resource type="PackedScene" uid="uid://bek03cid3jqis" path="res://Assets/SpaceShip/space_ship1.tscn" id="4_7bffy"]
[ext_resource type="MeshLibrary" uid="uid://c4tkwy28vus7r" path="res://Assets/SpaceStation/SpaceStationLibrary2.tres" id="5_1nfub"]
[ext_resource type="PackedScene" uid="uid://bd0wv7pusy0ny" path="res://Assets/MainRoboNpc/robo_npc.tscn" id="5_f4v3j"]
[ext_resource type="Script" uid="uid://j6uk3bm3wloq" path="res://Scripts/Character/NPC/TimedSetNPCPath.cs" id="6_dupto"]
[ext_resource type="Script" uid="uid://c2s22yw8odpfu" path="res://Scripts/FX/StepStompElementAudio.cs" id="6_iwjy4"]
[ext_resource type="Script" uid="uid://bb7a4dmjgaj7k" path="res://Scripts/Planets/PlanetContainer.cs" id="7_2ya38"]
[ext_resource type="AudioStream" uid="uid://balrle0hougg6" path="res://Assets/Sfx/footstep_metal.wav" id="7_lgn5n"]
[ext_resource type="Script" uid="uid://bswk5tpbwsuhe" path="res://Scripts/Planets/SpacePlanet.cs" id="8_1nfub"]
[ext_resource type="Script" uid="uid://c56o2roobej1u" path="res://Scripts/Audio/RandomizedSoundSettings.cs" id="8_xshdq"]
[ext_resource type="AudioStream" uid="uid://dky8yuiwr642r" path="res://Assets/Sfx/metal_bang.wav" id="9_rnnnw"]
[ext_resource type="PackedScene" uid="uid://c7vsnv78xsu04" path="res://Assets/SpaceStation/Prefabs/door.tscn" id="10_50s4j"]
[ext_resource type="Script" uid="uid://bopjhcd4s6yvs" path="res://Scripts/Planets/PlanetEnterHandler.cs" id="11_xshdq"]
[ext_resource type="Script" uid="uid://dt66hxdbn1urk" path="res://Scripts/Planets/PlanetFogHandler.cs" id="12_rnnnw"]
[ext_resource type="Script" uid="uid://c3526way25ka4" path="res://Scripts/Narrative/NarrativeHelper.cs" id="13_50s4j"]
[ext_resource type="AudioStream" uid="uid://cy3bdo8ktfvny" path="res://Assets/Sfx/Robob/test.ogg" id="14_48qqo"]
[ext_resource type="PackedScene" uid="uid://dtikojp8lsnt2" path="res://Assets/UI/dialogue_system.tscn" id="15_g85xq"]

[sub_resource type="CameraAttributesPractical" id="CameraAttributesPractical_rpadd"]
dof_blur_far_enabled = true
dof_blur_far_distance = 30.0
dof_blur_far_transition = -1.0
dof_blur_amount = 0.01

[sub_resource type="Resource" id="Resource_wfj1b"]
script = ExtResource("8_xshdq")
Sound = ExtResource("7_lgn5n")
MinVolume = -1.0
MaxVolume = -1.0
MinPitch = 0.9
MaxPitch = 1.1
metadata/_custom_type_script = "uid://c56o2roobej1u"

[sub_resource type="Resource" id="Resource_36hj1"]
script = ExtResource("8_xshdq")
Sound = ExtResource("9_rnnnw")
MinVolume = -1.0
MaxVolume = -1.0
MinPitch = 0.9
MaxPitch = 1.1
metadata/_custom_type_script = "uid://c56o2roobej1u"

[sub_resource type="Sky" id="Sky_j03km"]

[sub_resource type="Environment" id="Environment_c2tmr"]
background_mode = 1
sky = SubResource("Sky_j03km")
ambient_light_source = 2
ambient_light_color = Color(1, 1, 1, 1)
tonemap_white = 0.66
ssao_enabled = true
ssao_radius = 16.0
ssao_intensity = 0.65
ssao_power = 3.69343
ssao_detail = 5.0
ssil_intensity = 0.0
glow_normalized = true
glow_intensity = 2.76
glow_strength = 0.54
glow_bloom = 0.66
glow_blend_mode = 0
glow_hdr_luminance_cap = 0.6
volumetric_fog_density = 0.03
volumetric_fog_anisotropy = 0.47
volumetric_fog_sky_affect = 0.0
adjustment_brightness = 0.92
adjustment_contrast = 1.08
adjustment_saturation = 1.42

[sub_resource type="Curve3D" id="Curve3D_f3ejm"]
closed = true
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -3.4961, 2, 60.344, 0, 0, 0, 0, 0, 0, -0.925, 2, 64.846, 0, 0, 0, 0, 0, 0, -6.425, 2, 63.893),
"tilts": PackedFloat32Array(0, 0, 0)
}
point_count = 3

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_qbmcs"]
shading_mode = 0
albedo_color = Color(0.435192, 0.435192, 0.435192, 1)

[sub_resource type="SphereMesh" id="SphereMesh_fiers"]
flip_faces = true
radius = 100.0
height = 200.0

[sub_resource type="Animation" id="Animation_wagny"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CameraHandler:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(11.835, 2, -4.129)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("CameraHandler:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.523596, 1.56883, -0.00392987)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("CutsceneAnimator/AudioStreamPlayer:stream")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [null]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("CutsceneAnimator/AudioStreamPlayer:playing")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_dsmqm"]
resource_name = "test"
length = 17.1815
tracks/0/type = "method"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("NarrativeHelper")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 2.03333),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [],
"method": &"FreeCamera"
}, {
"args": [],
"method": &"ReturnCameraToPlayer"
}]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("CameraHandler:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0.0333333),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [Vector3(28.3, 2.2, -4.1)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("CameraHandler:rotation")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0.0333333),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [Vector3(0.523596, 1.56883, -0.00392987)]
}
tracks/3/type = "method"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("CanvasLayer/DialogueSystem")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(1.93333),
"transitions": PackedFloat32Array(1),
"values": [{
"args": ["Robob", "test", 15.0],
"method": &"ShowDialogue"
}]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("CutsceneAnimator/AudioStreamPlayer:stream")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(2),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("14_48qqo")]
}
tracks/5/type = "value"
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/path = NodePath("CutsceneAnimator/AudioStreamPlayer:playing")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/keys = {
"times": PackedFloat32Array(2.1),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_k4xbn"]
_data = {
&"RESET": SubResource("Animation_wagny"),
&"test": SubResource("Animation_dsmqm")
}

[node name="Chapter1" type="Node3D"]

[node name="Player" parent="." instance=ExtResource("1_ghnbm")]
transform = Transform3D(-0.965926, 0, -0.258819, 0, 1, 0, 0.258819, 0, -0.965926, -232.349, 2.68073, -13.3036)

[node name="CameraHandler" type="Camera3D" parent="."]
transform = Transform3D(1.38045e-06, 0.5, 0.866025, -0.00340336, 0.86602, -0.499998, -0.999994, -0.00294671, 0.00170288, 11.835, 2, -4.129)
attributes = SubResource("CameraAttributesPractical_rpadd")
far = 20000.0
script = ExtResource("2_r3dki")

[node name="AudioListener3D" type="AudioListener3D" parent="CameraHandler"]

[node name="VoxelViewer" type="VoxelViewer" parent="CameraHandler"]
view_distance = 512
view_distance_vertical_ratio = 2.0

[node name="Level" type="Node3D" parent="."]

[node name="SpaceStation" type="Node3D" parent="Level"]

[node name="player_room" parent="Level/SpaceStation" instance=ExtResource("3_dupto")]
transform = Transform3D(-1, 0, 1.50996e-07, 0, 1, 0, -1.50996e-07, 0, -1, 24, 0, -12)

[node name="Garage_Ship" parent="Level/SpaceStation" instance=ExtResource("4_2ya38")]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 85.6504, 0, 186.923)

[node name="GridMap" type="GridMap" parent="Level/SpaceStation"]
mesh_library = ExtResource("5_1nfub")
cell_size = Vector3(8, 8, 8)
cell_center_y = false
data = {
"cells": PackedInt32Array(65535, 65534, 0, 0, 65534, 1441799, 1, 65534, 1048583, 65535, 65533, 7, 65535, 65532, 655367, 65535, 65531, 655363, 65535, 65530, 655363, 65535, 65535, 655363, 65535, 0, 655363, 65535, 1, 655363, 65535, 2, 655363, 65535, 3, 655367, 65535, 4, 7, 65535, 5, 655363, 65535, 6, 655363, 65535, 7, 1048581, 65534, 7, 1048579, 65533, 7, 1048579, 65532, 7, 1048579, 65531, 7, 1048579, 65530, 7, 1048579, 65529, 7, 1048579, 65528, 7, 1048579, 65527, 7, 1048583, 65526, 7, 1441799, 65525, 7, 1441795, 65524, 7, 1441795, 65523, 7, 1441795, 65522, 7, 1441796, 65522, 6, 3, 65522, 5, 3, 65522, 4, 3, 65522, 3, 3, 65522, 2, 3, 65522, 1, 3, 65522, 0, 3, 65522, 65535, 3, 65521, 65534, 1441795, 65520, 65534, 1441795, 65519, 65534, 1048579, 65518, 65534, 1048579, 65517, 65534, 1048579, 65516, 65534, 1048579, 65521, 7, 1048579, 65520, 7, 1048579, 65519, 7, 1048579, 65518, 7, 1048579, 65517, 7, 1048579, 65516, 7, 1048579, 65515, 7, 1048579, 65514, 7, 1048579, 65513, 7, 1048579, 65512, 7, 1048579, 65511, 7, 1048583, 65510, 7, 1441799, 65509, 7, 1441795, 65508, 7, 1441795, 65507, 7, 1441795, 65506, 7, 1048583, 65505, 7, 1441799, 65504, 7, 1441795, 65503, 7, 1441795, 65515, 65534, 1441795, 65514, 65534, 1441795, 65513, 65534, 1441795, 65512, 65534, 1441795, 65511, 65534, 1048583, 65510, 65534, 1441799, 65509, 65534, 1441795, 65508, 65534, 1441795, 65507, 65534, 1441795, 65522, 65534, 1048580, -31, 65534, 8, -32, 65534, 1441795, -33, 65534, 1441795, -34, 65534, 1441795, -35, 65534, 1441795, -36, 65534, 1441795)
}
script = ExtResource("6_iwjy4")
StepSoundSettings = SubResource("Resource_wfj1b")
StompSoundSettings = SubResource("Resource_36hj1")
StepCooldown = 0.3
metadata/_editor_floor_ = Vector3(0, -1, 0)

[node name="Door" parent="Level/SpaceStation" instance=ExtResource("10_50s4j")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 2, 32)

[node name="Door2" parent="Level/SpaceStation" instance=ExtResource("10_50s4j")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 2, 48)

[node name="Door3" parent="Level/SpaceStation" instance=ExtResource("10_50s4j")]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -24, 2, -12)

[node name="Door4" parent="Level/SpaceStation" instance=ExtResource("10_50s4j")]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 8, 2, -12)

[node name="Settings" type="Node3D" parent="Level/SpaceStation"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Level/SpaceStation/Settings"]
environment = SubResource("Environment_c2tmr")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Level/SpaceStation/Settings"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 29.6809, 0)
light_volumetric_fog_energy = 0.0
light_specular = 0.0
light_bake_mode = 1
directional_shadow_mode = 0
directional_shadow_fade_start = 0.053

[node name="ShipTest" parent="." instance=ExtResource("4_7bffy")]
transform = Transform3D(-1, 0, -1.50996e-07, 0, 1, 0, 1.50996e-07, 0, -1, 85.6504, 3, 186.748)
linear_damp = 2.02

[node name="RoboNpc" parent="." instance=ExtResource("5_f4v3j")]
transform = Transform3D(0.691967, 0, 0.721929, 0, 1, 0, -0.721929, 0, 0.691967, -4.06984, 1.77884, 6.19701)

[node name="Path3D" type="Path3D" parent="."]
curve = SubResource("Curve3D_f3ejm")
script = ExtResource("6_dupto")
NpcNodePath = NodePath("../RoboNpc")

[node name="PlanetContainer" type="Node3D" parent="."]
script = ExtResource("7_2ya38")

[node name="SpacePlanet" type="Node3D" parent="PlanetContainer"]
script = ExtResource("8_1nfub")
WorldScenePath = "res://Assets/Planets/SpacePlanet/space_planet.tscn"
StartFogDistance = 400.0
EndFogDistance = 300.0
PlanetEnterDistance = 100.0
EnterSpaceHeight = 1000.0

[node name="PlanetEnterHandler" type="Node3D" parent="."]
script = ExtResource("11_xshdq")

[node name="Timer" type="Timer" parent="PlanetEnterHandler"]
wait_time = 2.0
autostart = true
ignore_time_scale = true

[node name="PlanetFogHandler" type="MeshInstance3D" parent="PlanetEnterHandler"]
material_override = SubResource("StandardMaterial3D_qbmcs")
transparency = 1.0
mesh = SubResource("SphereMesh_fiers")
script = ExtResource("12_rnnnw")

[node name="NarrativeHelper" type="Node" parent="."]
script = ExtResource("13_50s4j")

[node name="CutsceneAnimator" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_k4xbn")
}
autoplay = "test"

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="CutsceneAnimator"]

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="DialogueSystem" parent="CanvasLayer" instance=ExtResource("15_g85xq")]

[connection signal="timeout" from="PlanetEnterHandler/Timer" to="PlanetEnterHandler" method="UpdateClosestPlanet"]
